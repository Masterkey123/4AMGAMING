<!DOCTYPE html><html lang="my" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OutlineKeys Singapore Viewer</title>
    <meta name="description" content="Lightweight viewer for OutlineKeys country pages. Works on GitHub Pages." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui'] },
          },
        },
        darkMode: 'class',
      };
    </script>
    <style>
      html, body { height: 100%; }
      .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,0.6); }
      .glass-dark { backdrop-filter: blur(10px); background: rgba(17,24,39,0.6); }
    </style>
  </head>
  <body class="h-full bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-950 text-slate-800 dark:text-slate-100">
    <div class="min-h-full flex flex-col">
      <!-- Header -->
      <header class="sticky top-0 z-40">
        <div id="headerBar" class="glass dark:glass-dark border-b border-slate-200/60 dark:border-slate-700/40">
          <div class="mx-auto max-w-6xl px-4 py-3 flex items-center gap-3">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" class="shrink-0">
              <path d="M12 3l7 4v10l-7 4-7-4V7l7-4z" class="stroke-slate-700 dark:stroke-slate-200" stroke-width="1.5"/>
              <path d="M12 8v8M8 10l4-2 4 2" class="stroke-slate-500 dark:stroke-slate-400" stroke-width="1.5"/>
            </svg>
            <div class="flex-1">
              <h1 class="text-lg font-semibold leading-tight">OutlineKeys Singapore Viewer</h1>
              <p class="text-sm text-slate-600 dark:text-slate-400">GitHub Pages မှာဖွင့်ပြီး country page ကိုမြင်ရအောင် iframe + helper tools အသုံးပြုထားပါတယ်</p>
            </div>
            <button id="themeToggle" class="rounded-2xl px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 transition">Dark</button>
          </div>
        </div>
      </header><!-- Controls -->
  <section class="mx-auto w-full max-w-6xl px-4 pt-6">
    <div class="grid grid-cols-1 md:grid-cols-[1fr_auto_auto] gap-3 items-center">
      <label for="url" class="sr-only">Target URL</label>
      <input id="url" type="url" inputmode="url"
        class="w-full rounded-2xl border border-slate-300 dark:border-slate-700 bg-white/70 dark:bg-slate-900/70 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
        value="https://outlinekeys.com/country/singapore/" placeholder="https://example.com" />
      <button id="loadBtn" class="rounded-2xl px-4 py-3 text-sm font-medium bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm">Open</button>
      <div class="flex gap-2">
        <button id="newTabBtn" class="rounded-2xl px-3 py-3 text-sm border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800">Open in new tab</button>
        <button id="copyBtn" class="rounded-2xl px-3 py-3 text-sm border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800">Copy URL</button>
      </div>
    </div>
    <p class="mt-2 text-xs text-slate-500 dark:text-slate-400">မှတ်ချက် — တချို့的网站တွေမှာ security header (X-Frame-Options / CSP frame-ancestors) ကြောင့် iframe မှာ မဖွင့်နိုင်ပါ။ အဲဒီအတွက် New Tab နဲ့ ဖွင့်နိုင်အောင် ပြင်ပေးထားပါတယ်။</p>
  </section>

  <!-- Viewer -->
  <main class="mx-auto w-full max-w-6xl px-4 pb-10 flex-1 flex flex-col">
    <div class="relative mt-4 flex-1 rounded-3xl overflow-hidden border border-slate-200 dark:border-slate-800 shadow-sm">
      <!-- Loading overlay -->
      <div id="loading" class="absolute inset-0 flex items-center justify-center bg-white/70 dark:bg-slate-950/70 backdrop-blur-sm">
        <div class="animate-pulse text-center">
          <div class="mx-auto h-10 w-10 rounded-full border-2 border-slate-300 dark:border-slate-700 border-t-transparent animate-spin"></div>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-400">Loading…</p>
        </div>
      </div>

      <!-- Error banner (hidden by default) -->
      <div id="errorBanner" class="hidden absolute top-2 left-2 right-2 z-10 rounded-xl border border-amber-300/60 bg-amber-50/80 dark:bg-amber-900/30 px-4 py-3 text-sm text-amber-800 dark:text-amber-100">
        Embedding is blocked by the target site. Use <strong>Open in new tab</strong>.
      </div>

      <iframe id="frame" title="Embedded Site" class="w-full h-full bg-white dark:bg-slate-900" referrerpolicy="no-referrer" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"></iframe>
    </div>
  </main>

  <!-- Footer -->
  <footer class="border-t border-slate-200 dark:border-slate-800 py-6">
    <div class="mx-auto max-w-6xl px-4 text-xs text-slate-500 dark:text-slate-400 flex flex-col md:flex-row md:items-center gap-2 justify-between">
      <p>© <span id="year"></span> OutlineKeys Viewer • Static front-end for GitHub Pages</p>
      <div class="flex gap-3">
        <a class="hover:underline" href="#" id="shareLink">Share current URL</a>
        <a class="hover:underline" href="https://pages.github.com/" target="_blank" rel="noopener">What is GitHub Pages?</a>
      </div>
    </div>
  </footer>
</div>

<script>
  // Elements
  const urlInput = document.getElementById('url');
  const frame = document.getElementById('frame');
  const loadBtn = document.getElementById('loadBtn');
  const newTabBtn = document.getElementById('newTabBtn');
  const copyBtn = document.getElementById('copyBtn');
  const loading = document.getElementById('loading');
  const errorBanner = document.getElementById('errorBanner');
  const themeToggle = document.getElementById('themeToggle');
  const shareLink = document.getElementById('shareLink');

  // Persist dark mode
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const storedTheme = localStorage.getItem('theme');
  const isDark = storedTheme ? storedTheme === 'dark' : prefersDark;
  document.documentElement.classList.toggle('dark', isDark);
  themeToggle.textContent = isDark ? 'Light' : 'Dark';

  themeToggle.addEventListener('click', () => {
    const nowDark = !document.documentElement.classList.contains('dark');
    document.documentElement.classList.toggle('dark', nowDark);
    localStorage.setItem('theme', nowDark ? 'dark' : 'light');
    themeToggle.textContent = nowDark ? 'Light' : 'Dark';
  });

  // Year
  document.getElementById('year').textContent = new Date().getFullYear();

  // Load URL into iframe
  function normalize(url) {
    try {
      const u = new URL(url);
      return u.toString();
    } catch (e) {
      return 'https://' + url.replace(/^https?:\/\//, '');
    }
  }

  function load(url) {
    loading.classList.remove('hidden');
    errorBanner.classList.add('hidden');
    const target = normalize(url);
    frame.src = target;

    // Fallback: if embedding is blocked, show banner after timeout
    const start = Date.now();
    const timeoutMs = 3500;
    const check = () => {
      const elapsed = Date.now() - start;
      // We can't poke into cross-origin frame; we just time out
      if (elapsed > timeoutMs) {
        loading.classList.add('hidden');
        errorBanner.classList.remove('hidden');
      } else if (frame.contentWindow && frame.contentWindow.location && frame.contentWindow.location.href === 'about:blank') {
        // still blank -> keep waiting
        requestAnimationFrame(check);
      } else {
        // assume loaded
        loading.classList.add('hidden');
      }
    };
    requestAnimationFrame(check);
  }

  // Wire up controls
  loadBtn.addEventListener('click', () => load(urlInput.value));
  urlInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') load(urlInput.value); });
  newTabBtn.addEventListener('click', () => { window.open(normalize(urlInput.value), '_blank', 'noopener'); });
  copyBtn.addEventListener('click', async () => {
    try { await navigator.clipboard.writeText(normalize(urlInput.value)); copyBtn.textContent = 'Copied'; setTimeout(() => copyBtn.textContent = 'Copy URL', 1500); } catch {}
  });

  // Share current URL via query string
  function applyFromQuery() {
    const params = new URLSearchParams(location.search);
    const q = params.get('u');
    if (q) { urlInput.value = q; }
    load(urlInput.value);
  }
  shareLink.addEventListener('click', (e) => {
    e.preventDefault();
    const u = new URL(location.href);
    u.searchParams.set('u', normalize(urlInput.value));
    history.replaceState(null, '', u.toString());
    navigator.clipboard.writeText(u.toString()).then(() => {
      shareLink.textContent = 'Link copied!';
      setTimeout(() => (shareLink.textContent = 'Share current URL'), 1500);
    });
  });

  // Auto-load on first paint
  applyFromQuery();
</script>

  </body>
</html>
